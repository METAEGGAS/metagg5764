<!doctype html><html lang="ar" dir="rtl"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="theme-color" content="#0f1d35"><title>QT Real Trading</title><style>
*{margin:0;padding:0;box-sizing:border-box}html,body{height:100%;overflow:hidden}body{font-family:Arial,sans-serif;background:#0a1628;color:#fff;direction:rtl;display:flex;flex-direction:column;font-size:12.6px}
.header{flex:0 0 auto;display:flex;justify-content:space-between;align-items:center;padding:4px 10px;background:#0f1d35;position:relative}
.header::after{content:'';position:absolute;bottom:-8px;left:0;right:0;height:8px;background:linear-gradient(to bottom,#0f1d35,transparent);pointer-events:none;z-index:5}
.header-left{display:flex;gap:8px;align-items:center}.header-center{display:flex;gap:8px;align-items:center}.header-right{display:flex;align-items:center;gap:8px}
.icon-btn{width:38px;height:38px;background:rgba(255,255,255,.05);border-radius:8px;display:flex;align-items:center;justify-content:center;border:0;cursor:pointer;padding:0}
.logo-btn img{width:100%;height:100%;display:block;object-fit:cover}
.balance-box{background:#0f1d35;padding:8px 14px;border-radius:10px;min-height:46px;display:flex;align-items:center;justify-content:space-between;gap:10px;border:1px solid rgba(255,255,255,.12);position:relative;cursor:pointer;user-select:none;z-index:2601}
.balance-main{display:flex;align-items:center;gap:9px;min-width:0;flex:1}
.acc-top-icon{width:20px;height:14px;border-radius:3px;box-shadow:0 2px 4px rgba(0,0,0,.3);flex:0 0 auto;object-fit:cover}
.balance-label{font-size:9.5px;color:#fff;font-weight:700;letter-spacing:.3px;margin-bottom:2px}
.balance-amount{font-size:15px;font-weight:900;letter-spacing:.4px;color:#fff}
.balance-content{display:flex;flex-direction:column;min-width:0}
.balance-arrow{display:flex;align-items:center;justify-content:center;color:#8b9cb5;font-size:16px;transition:transform .2s}
.balance-box.open .balance-arrow{transform:rotate(180deg)}
.wallet-btn{width:38px;height:38px;background:#16a34a;border-radius:8px;border:2px solid rgba(255,255,255,.15);cursor:pointer;display:flex;align-items:center;justify-content:center;padding:0;overflow:hidden}
.wallet-btn img{width:100%;height:100%;display:block;object-fit:cover}
.time-display{position:absolute;left:8px;top:calc(100% + 8px);font-size:11px;color:#8b9cb5;font-weight:700;letter-spacing:.4px;background:rgba(15,29,53,.95);padding:6px 12px;border-radius:6px;z-index:180;border:1px solid rgba(255,255,255,.1);display:flex;align-items:center;gap:6px}
.time-display::before{content:'';width:6px;height:6px;background:#0f0;border-radius:50%;box-shadow:0 0 8px #0f0;animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
.chart-container{flex:1 1 auto;min-height:0;background:#0a1628;position:relative;overflow:hidden}
.quick-actions{position:absolute;top:52px;left:8px;display:flex;flex-direction:column;gap:6px;z-index:190;pointer-events:none}
.quick-actions button{pointer-events:auto}
.qa-btn{width:44px;height:44px;background:#0f1d35;border:1px solid rgba(255,255,255,.12);border-radius:8px;display:flex;align-items:center;justify-content:center;padding:0;cursor:pointer;transition:background .15s}
.qa-btn:hover{background:#1a2942}.qa-btn:active{background:#213554}
.chart-frame{position:relative;width:100%;height:100%;overflow:hidden}
.plot{position:absolute;inset:0;overflow:hidden}
#chartCanvas{display:block;position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%;touch-action:none;cursor:grab}
#chartCanvas:active{cursor:grabbing}
.candle-timer{position:absolute;color:rgba(255,255,255,.35);font-size:11px;font-weight:700;z-index:180;pointer-events:none;font-family:monospace}
.price-line{position:absolute;left:0;right:0;height:2px;background:transparent;z-index:150;pointer-events:none;border-top:2px dashed rgba(255,255,255,.7)}
.timeLabels{position:absolute;left:0;right:0;bottom:0;height:24px;background:rgba(10,22,40,.95);border-top:1px solid rgba(255,255,255,.08);pointer-events:none;z-index:160}
.timeLabel{position:absolute;bottom:2px;font-size:8.5px;font-weight:900;color:rgba(255,255,255,.55);transform:translateX(-50%);white-space:nowrap}
.timeLabel.major{color:rgba(255,215,0,.85);font-weight:900}
#priceScale{position:absolute;top:0;right:0;bottom:0;width:50px;pointer-events:none;z-index:170;background:transparent!important;border:none!important;box-shadow:none!important}
#priceScaleLabels{position:absolute;inset:0;background:transparent!important;border:none!important;box-shadow:none!important}
#currentPrice{position:absolute;right:8px;transform:translateY(-50%);color:#000;font-size:10px;font-weight:900;white-space:nowrap;background:#ffd700!important;padding:4px 8px!important;border-radius:4px!important;box-shadow:0 0 10px rgba(255,215,0,.6)!important;text-shadow:none!important;border:1px solid rgba(255,215,0,.8)!important}
#priceScale .pLabel{position:absolute;right:8px;transform:translateY(-50%);font-size:9px;font-weight:800;color:#fff;white-space:nowrap;background:transparent!important;box-shadow:none!important;border:none!important;text-shadow:0 0 6px rgba(255,255,255,.4)!important;padding:0!important;margin:0!important;filter:brightness(1.3)}
#priceScale .pLabel.major{color:#fff;filter:brightness(1.5)}
.controls{flex:0 0 auto;padding:9px 10.8px 0;background:#0f1d35}
.timer-amount{display:flex;gap:7.2px;margin-bottom:9px}
.control-group{flex:1;display:flex;flex-direction:column;gap:5.4px}
.control-label{font-size:9.9px;color:#8b9cb5;font-weight:600;text-align:center}
.control-value{background:#0a1628;padding:9px 14px;border-radius:9px;border:1px solid rgba(255,255,255,.2);font-size:16px;font-weight:700;display:flex;align-items:center;justify-content:center;gap:10px;cursor:pointer;position:relative;user-select:none;width:100%;min-height:46px;box-shadow:inset 0 2px 8px rgba(0,0,0,.4)}
.control-value:hover{background:#0d1a2e}
.control-text{flex:1;text-align:center}
.control-icon{width:18px;height:18px;flex-shrink:0;display:flex;align-items:center;justify-content:center}
.dropdown{position:absolute;bottom:calc(100% + 7.2px);left:-9px;right:-9px;background:#1a2942;border-radius:10.8px;box-shadow:0 -3.6px 18px rgba(0,0,0,.6);z-index:200;display:none;border:1px solid rgba(255,255,255,.15);max-width:360px;width:auto;min-width:calc(100% + 18px)}
.dropdown.show{display:block}
.dropdown-header{display:flex;border-bottom:1px solid rgba(255,255,255,.1);padding:3.6px}
.dropdown-tab{flex:1;padding:9px 14.4px;text-align:center;font-size:10.8px;cursor:pointer;background:transparent;border:0;color:#8b9cb5;font-weight:700;border-radius:7.2px;transition:all .2s}
.dropdown-tab.active{color:#fff;background:rgba(59,130,246,.2)}
.dropdown-content{max-height:216px;overflow-y:auto;padding:5.4px;display:grid;grid-template-columns:repeat(3,1fr);gap:4px}
.dropdown-item{padding:10.8px 8px;font-size:12.6px;cursor:pointer;border-radius:7.2px;font-weight:600;transition:all .2s;text-align:center}
.dropdown-item:hover{background:rgba(59,130,246,.15);color:#3b82f6}
.custom-input{padding:7.2px 10.8px;display:none}.custom-input.show{display:block}
.time-input{width:100%;background:#0f1d35;border:1px solid rgba(255,255,255,.2);border-radius:7.2px;padding:10.8px;color:#fff;font-size:14.4px;text-align:center;font-weight:700;letter-spacing:.9px}
#timeDisplay.editing{background:#0f1d35;border:1px solid rgba(59,130,246,.5);outline:none;cursor:text;color:#fff}
#amountDisplay{background:transparent;border:none;color:#fff;font-size:16px;text-align:center;font-weight:700;outline:none;width:100%;cursor:text;padding:0}
#amountDisplay:focus{outline:none}
.trade-buttons{display:flex;gap:7.2px;margin:9px 0 5.4px}
.trade-btn{flex:1;height:38px;border:0;border-radius:10.8px;font-size:13.5px;font-weight:800;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:7.2px;transition:transform .2s}
.trade-btn:active{transform:scale(.96)}
.buy-btn{background:linear-gradient(135deg,#0f0,#0c0);color:#fff}.buy-btn:before{content:"‚Üó";font-size:16.2px}
.sell-btn{background:linear-gradient(135deg,#f00,#c00);color:#fff}.sell-btn:before{content:"‚Üò";font-size:16.2px}
.ai-trade-btn{flex:2;background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff}.ai-trade-btn:before{content:"AI";margin-right:4.5px;font-weight:900}
.bottom-nav{flex:0 0 auto;background:#0f1d35;display:flex;justify-content:space-around;padding:7.2px 0;border-top:1px solid rgba(255,255,255,.05)}
.nav-item{display:flex;flex-direction:column;align-items:center;gap:3.6px;color:#6b7a94;font-size:9px;cursor:pointer}
.nav-item.active{color:#3b82f6}
.nav-icon{width:21.6px;height:21.6px;display:flex;align-items:center;justify-content:center;font-size:16.2px}
.loading-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(10,22,40,.95);display:flex;align-items:center;justify-content:center;z-index:9999;display:none}
.loading-overlay.show{display:flex}
.loading-content{text-align:center}
.loading-spinner{width:50px;height:50px;border:4px solid rgba(59,130,246,.3);border-top-color:#3b82f6;border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 20px}
@keyframes spin{to{transform:rotate(360deg)}}
.loading-text{color:#fff;font-size:14px;font-weight:600}
/* ===== Pair HUD + Panel ===== */
.pair-box{position:absolute;left:8px;bottom:32px;z-index:175;display:inline-flex;align-items:center;gap:6.6px;background:#0f1d35;border:1.1px solid rgba(255,255,255,.12);border-radius:11px;padding:5.5px 9.9px;cursor:pointer;user-select:none;backdrop-filter:blur(8px)}
.pair-box .flags{display:flex;align-items:center;margin-inline:2px}
.pair-box .flags img{width:24.2px;height:24.2px;border-radius:999px;border:2.2px solid #101a2f;margin-left:-8.8px;background:#101a2f;object-fit:cover}
.pair-box .otc{margin-inline-start:6.6px;padding:2.2px 6.6px;border-radius:999px;background:rgba(255,255,255,.10);border:1.1px solid rgba(255,255,255,.18);font-size:11px;font-weight:1000;letter-spacing:.44px}
.pairPanel{position:fixed;left:0;top:0;bottom:0;width:18vw;min-width:280px;max-width:420px;background:rgba(10,22,40,.72);border-right:1.5px solid rgba(255,255,255,.12);backdrop-filter:blur(10px);z-index:99998;transform:translateX(-105%);transition:transform .25s ease;pointer-events:auto;box-shadow:4px 0 24px rgba(0,0,0,.6)}
.pairPanel.on{transform:translateX(0)}
.pairHead{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1.5px solid rgba(255,255,255,.12);background:linear-gradient(to bottom,rgba(255,255,255,.03),transparent);user-select:none}
.pairHead b{font-size:15px;font-weight:1000;color:#fff;letter-spacing:.3px}
.pairClose{width:36px;height:36px;border-radius:11px;background:rgba(255,255,255,.08);border:1.5px solid rgba(255,255,255,.12);color:#d9e6ff;font-weight:1000;transition:.2s;cursor:pointer}
.pairList{padding:10px 12px;max-height:calc(100vh - 80px);overflow-y:auto}
.pit{width:100%;display:flex;align-items:center;justify-content:space-between;gap:11px;padding:11px 13.2px;border-radius:13.2px;background:rgba(255,255,255,.03);border:1.5px solid rgba(255,255,255,.12);color:#d9e6ff;margin:6.6px 0;transition:.2s;cursor:pointer}
.pit:hover{background:rgba(255,255,255,.05)}
.pitL{display:flex;align-items:center;gap:11px;min-width:0}
.star{width:19.8px;height:19.8px;border-radius:6.6px;background:rgba(255,159,42,.10);border:1.1px solid rgba(255,159,42,.30);display:grid;place-items:center;color:#ffb357;font-size:13.2px;flex:0 0 auto}
.fg{display:flex;align-items:center}
.fg img{width:24.2px;height:24.2px;border-radius:999px;border:2.2px solid #101a2f;margin-left:-8.8px;background:#101a2f;object-fit:cover}
.nm{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:1000}
.bad{margin-inline-start:6.6px;padding:2.2px 6.6px;border-radius:999px;background:rgba(255,255,255,.08);border:1.1px solid rgba(255,255,255,.12);font-size:11px;font-weight:1000}
/* ===== ÿ≥ÿ¨ŸÑ ÿßŸÑÿµŸÅŸÇÿßÿ™ ===== */
:root{--histH:30vh}
#hb{position:fixed;inset:0;background:rgba(0,0,0,.35);backdrop-filter:blur(2px);z-index:99996;display:none}
#hs{position:fixed;left:0;right:0;bottom:0;height:var(--histH);min-height:190px;max-height:360px;background:#1f2736;color:#e9eef7;z-index:99997;transform:translateY(105%);transition:transform .22s ease;border-top:1px solid #2e384b;box-shadow:0 -10px 30px rgba(0,0,0,.55)}
#hs.on{transform:translateY(0)}
#hb.on{display:block}
#hs .hh{height:44px;display:grid;grid-template-columns:1fr auto 1fr;align-items:center;padding:0 12px;background:#1f2736;border-bottom:1px solid #2e384b;position:relative}
#hs .hh:before{content:"";position:absolute;left:0;right:0;top:0;height:3px;background:#2e7bef}
#hs .hhL{display:flex;align-items:center;gap:10px;opacity:.85}
#hs .hhL .ic{width:22px;height:22px;border-radius:999px;background:rgba(255,255,255,.06);display:grid;place-items:center;font-weight:800;font-size:12px;color:#b8c3d6;border:1px solid rgba(255,255,255,.10)}
#hs .hhC{display:flex;align-items:center;gap:8px;justify-content:center}
#hs .hhC .ttl{font-size:16px;font-weight:800;letter-spacing:.2px}
#hs .hhC .bdg{min-width:22px;height:22px;border-radius:999px;background:#3a465c;display:grid;place-items:center;font-weight:900;font-size:12px;color:#fff}
#hs .hhR{display:flex;justify-content:flex-end}
#hs .hhR button{width:34px;height:34px;border-radius:10px;background:rgba(255,255,255,.07);border:1px solid rgba(255,255,255,.10);color:#b8c3d6;font-size:18px;font-weight:900;cursor:pointer}
#hs .hlst{height:calc(100% - 44px);overflow:auto;padding-top:6px}
#hs .htabs{display:flex;gap:4px;padding:6px 12px 4px;border-bottom:1px solid #2e384b;background:#1a2330}
#hs .htab{flex:1;padding:5px 8px;border-radius:7px;font-size:10.5px;font-weight:900;letter-spacing:.3px;background:transparent;border:1px solid rgba(255,255,255,.10);color:#6b7a94;cursor:pointer;transition:.2s;text-align:center}
#hs .htab.active{background:rgba(46,123,239,.18);border-color:#2e7bef;color:#e9eef7}
#hs .htab .tc{display:inline-block;min-width:16px;height:16px;border-radius:999px;background:#3a465c;font-size:10px;font-weight:900;line-height:16px;text-align:center;margin-inline-start:4px;padding:0 3px}
#hs .htab.active .tc{background:#2e7bef}
#hs .hrw{display:flex;justify-content:space-between;gap:12px;padding:10px 14px;background:#242d3e;border-top:1px solid #2e384b}
#hs .hrw:first-child{border-top:0}
#hs .lft{display:flex;gap:10px;min-width:0;align-items:flex-start}
#hs .car{color:#b7c2d6;font-size:16px;line-height:1;margin-top:2px}
#hs .tm{font-size:18px;font-weight:700;color:#e9eef7;direction:ltr;text-align:left}
#hs .pf{margin-top:6px;font-size:18px;font-weight:1000;direction:ltr;text-align:left}
#hs .pf.pos{color:#22c55e}
#hs .pf.neg{color:#e15353}
#hs .rgt{display:flex;flex-direction:column;gap:8px;align-items:flex-end;min-width:0}
#hs .pr{display:flex;align-items:center;gap:8px;white-space:nowrap}
#hs .pr .pair{font-size:18px;font-weight:900;color:#e9eef7;direction:ltr}
#hs .flg{display:flex;align-items:center;gap:6px}
#hs .flg img{width:20px;height:20px;border-radius:999px;border:1px solid rgba(230,236,246,.8);object-fit:cover}
#hs .amt{display:flex;align-items:center;gap:10px}
#hs .amt .v{font-size:20px;font-weight:1000;direction:ltr}
#hs .amt .v.up{color:#22c55e}
#hs .amt .v.dn{color:#e15353}
#hs .amt .d{width:26px;height:26px;border-radius:999px;background:#3a465c;display:grid;place-items:center;border:1px solid rgba(255,255,255,.10)}
#hs .amt .d span{font-size:16px;line-height:1}
#hs .amt .d.up span{color:#22c55e}
#hs .amt .d.dn span{color:#e15353}
#hs .hrw.closed{background:#1e2a3a}
#hs .hrw.closed .tm{font-size:13px;color:#8b9cb5}
#hs .result-badge{font-size:10px;font-weight:900;padding:3px 8px;border-radius:6px;letter-spacing:.4px;margin-top:2px;display:inline-block}
#hs .result-badge.win{background:rgba(34,197,94,.15);color:#22c55e;border:1px solid rgba(34,197,94,.3)}
#hs .result-badge.loss{background:rgba(225,83,83,.15);color:#e15353;border:1px solid rgba(225,83,83,.3)}
#hs .empty-msg{text-align:center;padding:28px 20px;color:#6b7a94;font-size:13px;line-height:1.7}
#hs .empty-msg span{font-size:26px;display:block;margin-bottom:8px;opacity:.5}
</style></head><body>
<div class="loading-overlay" id="loadingOverlay"><div class="loading-content"><div class="loading-spinner"></div><div class="loading-text">ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™...</div></div></div>

<div class="header">
  <div class="header-left">
    <div class="balance-box" id="balanceBox" aria-label="Account Switcher">
      <div class="balance-main">
        <img class="acc-top-icon" id="topAccIcon" src="https://flagcdn.com/w40/us.png" alt="account">
        <div class="balance-content"><div class="balance-label" id="balLabel">QT Demo USD</div><div class="balance-amount" id="balAmount">$10,000.00</div></div>
      </div>
      <div class="balance-arrow" aria-hidden="true"><svg width="18" height="18" viewBox="0 0 24 24" fill="#8b9cb5"><path d="M7 10l5 5 5-5z"></path></svg></div>
      <!-- ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ŸáŸäÿ™ÿπŸÖŸÑŸáÿß Inject ŸÖŸÜ chart.js (qtAccMenu) -->
    </div>
  </div>
  <div class="header-center">
    <button class="wallet-btn" aria-label="Wallet" onclick="window.location.href='wallet.html'"><img src="https://cdn-icons-png.flaticon.com/128/10167/10167706.png" alt="Wallet"></button>
    <button class="icon-btn logo-btn" aria-label="QT" onclick="window.location.href='profile.html'"><img id="userAvatarImg" src="https://cdn-icons-png.flaticon.com/128/18921/18921105.png" alt="QT"></button>
  </div>
  <div class="time-display" id="liveTime">00:00:00 UTC+3</div>
</div>

<div class="chart-container">
  <div class="quick-actions">
    <button class="qa-btn" id="openHistory" aria-label="Trade History"><svg width="42" height="42" viewBox="0 0 24 24" fill="none"><defs><linearGradient id="gradBag" x1="0" y1="0" x2="24" y2="24"><stop offset="0%" stop-color="#4a90e2"></stop><stop offset="100%" stop-color="#357abd"></stop></linearGradient></defs><rect x="3" y="7" width="18" height="13" rx="3" stroke="url(#gradBag)" stroke-width="2" fill="none"></rect><path d="M8 7V5a4 4 0 0 1 8 0v2" stroke="url(#gradBag)" stroke-width="2" stroke-linecap="round"></path><line x1="7" y1="12" x2="17" y2="12" stroke="url(#gradBag)" stroke-width="1.6" stroke-linecap="round"></line></svg></button>
    <button class="qa-btn" aria-label="Options" style="color:#4a90e2"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><line x1="5" y1="7" x2="19" y2="7" stroke="currentColor" stroke-width="2" stroke-linecap="round"></line><line x1="5" y1="12" x2="19" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"></line><line x1="5" y1="17" x2="19" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round"></line></svg></button>
  </div>

  <div class="chart-frame"><div class="plot" id="plot">
    <canvas id="chartCanvas"></canvas><div class="price-line" id="priceLine"></div><div class="candle-timer" id="candleTimer">59</div>
    <div id="priceScale"><div id="priceScaleLabels"></div><div id="currentPrice"></div></div><div class="timeLabels" id="timeLabels"></div>
    <div class="pair-box" id="pairHud"><span id="pairHudTxt">EUR/USD</span><span class="otc" id="otcHud">OTC</span><span class="flags" id="pairFlags"></span><span style="opacity:.7">‚ñæ</span></div>
  </div></div>
</div>

<div class="controls">
  <div class="timer-amount">
    <div class="control-group">
      <div class="control-label">Time</div>
      <div class="control-value" id="timeSelector">
        <span class="control-text" id="timeDisplay">00:05</span>
        <div class="control-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#3B82F6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 7v5l3 2"></path></svg></div>
        <div class="dropdown" id="timeDropdown"><div class="dropdown-header"><button class="dropdown-tab active" id="tabCompensation">Quick</button><button class="dropdown-tab" id="tabCustom">Custom</button></div>
          <div class="dropdown-content" id="compensationList">
            <div class="dropdown-item" data-sec="5">00:05</div><div class="dropdown-item" data-sec="10">00:10</div><div class="dropdown-item" data-sec="15">00:15</div><div class="dropdown-item" data-sec="30">00:30</div><div class="dropdown-item" data-sec="60">01:00</div><div class="dropdown-item" data-sec="120">02:00</div><div class="dropdown-item" data-sec="300">05:00</div><div class="dropdown-item" data-sec="600">10:00</div><div class="dropdown-item" data-sec="900">15:00</div><div class="dropdown-item" data-sec="1800">30:00</div><div class="dropdown-item" data-sec="3600">01:00:00</div><div class="dropdown-item" data-sec="7200">02:00:00</div>
          </div>
        </div>
      </div>
    </div>
    <div class="control-group">
      <div class="control-label">Amount</div>
      <div class="control-value" id="amountContainer">
        <input type="text" class="control-text" id="amountDisplay" value="50$">
        <div class="control-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#3B82F6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 6v12"></path><path d="M15 9.5c0-1.4-1.3-2.5-3-2.5s-3 1.1-3 2.5 1.3 2.5 3 2.5 3 1.1 3 2.5-1.3 2.5-3 2.5-3-1.1-3-2.5"></path></svg></div>
      </div>
    </div>
  </div>
  <div class="trade-buttons"><button class="trade-btn buy-btn" id="buyBtn">BUY</button><button class="trade-btn ai-trade-btn">TRADING</button><button class="trade-btn sell-btn" id="sellBtn">SELL</button></div>
</div>

<div class="bottom-nav">
  <div class="nav-item active"><div class="nav-icon"><svg width="21.6" height="21.6" viewBox="0 0 24 24" fill="none"><rect x="2" y="2" width="20" height="20" rx="2" ry="2" stroke="currentColor" stroke-width="1.5" fill="none"></rect><line x1="4" y1="20" x2="20" y2="20" stroke="currentColor" stroke-width=".8"></line><line x1="4" y1="4" x2="4" y2="20" stroke="currentColor" stroke-width=".8"></line><polyline points="4,16 8,12 12,14 16,8 20,10" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></polyline><circle cx="4" cy="16" r="1.2" fill="currentColor"></circle><circle cx="8" cy="12" r="1.2" fill="currentColor"></circle><circle cx="12" cy="14" r="1.2" fill="currentColor"></circle><circle cx="16" cy="8" r="1.2" fill="currentColor"></circle><circle cx="20" cy="10" r="1.2" fill="currentColor"></circle></svg></div><div>Chart</div></div>
  <div class="nav-item" id="navHistory"><div class="nav-icon"><svg width="21.6" height="21.6" viewBox="0 0 24 24" fill="none"><rect x="3" y="7" width="18" height="14" rx="2" ry="2" fill="currentColor"></rect><rect x="8" y="3" width="8" height="4" rx="1" ry="1" fill="currentColor"></rect><line x1="6" y1="11" x2="18" y2="11" stroke="#0a1628" stroke-width="1"></line><line x1="6" y1="14" x2="18" y2="14" stroke="#0a1628" stroke-width="1"></line><line x1="6" y1="17" x2="18" y2="17" stroke="#0a1628" stroke-width="1"></line></svg></div><div>History</div></div>
  <div class="nav-item" onclick="window.location.href='profile.html'"><div class="nav-icon"><svg width="21.6" height="21.6" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="11" stroke="currentColor" stroke-width="2" fill="none"></circle><circle cx="12" cy="8" r="3" fill="currentColor"></circle><path d="M6 20c0-3.3 5-5 6-5s6 1.7 6 5" fill="currentColor"></path></svg></div><div>Profile</div></div>
  <div class="nav-item"><div class="nav-icon"><svg width="21.6" height="21.6" viewBox="0 0 24 24" fill="none"><rect x="2" y="2" width="20" height="20" rx="3" ry="3" stroke="currentColor" stroke-width="1.5" fill="none"></rect><rect x="8" y="18" width="8" height="2" fill="currentColor"></rect><rect x="11" y="10" width="2" height="8" fill="currentColor"></rect><path d="M6 10 C6 6, 18 6, 18 10 C18 14, 6 14, 6 10 Z" fill="currentColor"></path><path d="M6 10 C4 10, 4 12, 6 12" stroke="currentColor" stroke-width="1.5" fill="none"></path><path d="M18 10 C20 10, 20 12, 18 12" stroke="currentColor" stroke-width="1.5" fill="none"></path></svg></div><div>Rank</div></div>
  <div class="nav-item"><div class="nav-icon"><svg width="21.6" height="21.6" viewBox="0 0 24 24" fill="none"><rect x="2" y="2" width="20" height="20" rx="3" ry="3" stroke="currentColor" stroke-width="1.5" fill="none"></rect><circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="2" fill="currentColor"></circle><line x1="12" y1="2" x2="12" y2="5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></line><line x1="12" y1="19" x2="12" y2="22" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></line><line x1="2" y1="12" x2="5" y2="12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></line><line x1="19" y1="12" x2="22" y2="12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></line><line x1="5" y1="5" x2="7" y2="7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></line><line x1="17" y1="17" x2="19" y2="19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></line><line x1="5" y1="19" x2="7" y2="17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></line><line x1="17" y1="7" x2="19" y2="5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></line></svg></div><div>Settings</div></div>
</div>

<div class="pairPanel" id="pairPanel"><div class="pairHead"><b>ÿßŸÑÿßÿ≤Ÿàÿßÿ¨</b><button class="pairClose" id="pairClose" type="button">√ó</button></div><div class="pairList" id="pairList"></div></div>

<div id="hb"></div>
<div id="hs">
  <div class="hh">
    <div class="hhL"><span class="ic" id="hOpenCnt">0</span><span class="ic">üïí</span></div>
    <div class="hhC"><span class="bdg" id="hCnt">0</span><span class="ttl">ÿßŸÑÿ™ÿØÿßŸàŸÑÿßÿ™</span></div>
    <div class="hhR"><button id="hX" type="button">√ó</button></div>
  </div>
  <div class="htabs">
    <button class="htab active" id="htabOpen" type="button">ŸÖŸÅÿ™Ÿàÿ≠ÿ© <span class="tc" id="tcOpen">0</span></button>
    <button class="htab" id="htabClosed" type="button">ŸÖŸÜÿ™ŸáŸäÿ© <span class="tc" id="tcClosed">0</span></button>
  </div>
  <div class="hlst" id="hList"></div>
</div>

<!-- Pair switch UI -->
<script>
(function(){
var hud=document.getElementById("pairHud"),panel=document.getElementById("pairPanel"),closeBtn=document.getElementById("pairClose"),list=document.getElementById("pairList");
var hudTxt=document.getElementById("pairHudTxt"),otc=document.getElementById("otcHud"),flagsBox=document.getElementById("pairFlags");
if(!hud||!panel||!list||!hudTxt||!flagsBox)return;
var fM={AED:"ae",CNY:"cn",AUD:"au",CAD:"ca",CHF:"ch",BHD:"bh",EUR:"eu",RUB:"ru",USD:"us",KES:"ke",LBP:"lb",QAR:"qa",TRY:"tr",SYP:"sy",EGP:"eg",INR:"in",IRR:"ir"};
var mkF=function(c){c=(c||"un").toUpperCase();return "https://flagcdn.com/w40/"+String((fM[c]||c)).toLowerCase()+".png"};
var pairs=[{pair:"AED/CNY",otc:1,payout:.91,flags:["AED","CNY"]},{pair:"AUD/CAD",otc:1,payout:.88,flags:["AUD","CAD"]},{pair:"AUD/CHF",otc:1,payout:.92,flags:["AUD","CHF"]},{pair:"BHD/CNY",otc:1,payout:.86,flags:["BHD","CNY"]},{pair:"EUR/RUB",otc:1,payout:.77,flags:["EUR","RUB"]},{pair:"EUR/USD",otc:1,payout:.92,flags:["EUR","USD"]},{pair:"KES/USD",otc:1,payout:.84,flags:["KES","USD"]},{pair:"LBP/USD",otc:1,payout:.79,flags:["LBP","USD"]},{pair:"QAR/CNY",otc:1,payout:.83,flags:["QAR","CNY"]},{pair:"USD/CHF",otc:1,payout:.89,flags:["USD","CHF"]},{pair:"SYP/TRY",otc:1,payout:.87,flags:["SYP","TRY"]},{pair:"EGP/USD",otc:1,payout:.78,flags:["EGP","USD"]},{pair:"USD/INR",otc:1,payout:.90,flags:["USD","INR"]}];
var fav=new Set(),fmtP=function(x){return Math.round((+x||0)*100)+"%"};
var setHud=function(p){
hudTxt.textContent=p.pair;
if(otc){otc.textContent=p.otc?"OTC":"";otc.style.display=p.otc?"inline-flex":"none"}
var f=p.flags||String(p.pair).split("/");
flagsBox.innerHTML='<img src="'+mkF(f[0])+'" alt=""><img src="'+mkF(f[1])+'" alt="">';
};
var render=function(){
pairs.sort(function(a,b){var fa=fav.has(a.pair)?1:0,fb=fav.has(b.pair)?1:0;if(fa!==fb)return fb-fa;return a.pair.localeCompare(b.pair)});
list.innerHTML=pairs.map(function(x){
var ab=String(x.pair).split("/"),st=fav.has(x.pair)?"‚òÖ":"‚òÜ";
return '<button class="pit" data-p="'+x.pair+'" type="button"><span class="pitL"><span class="star" data-s="1">'+st+'</span><span class="fg"><img src="'+mkF(ab[0])+'" alt=""><img src="'+mkF(ab[1])+'" alt=""></span><span class="nm">'+x.pair+'<span class="bad">OTC</span></span></span><span>+'+fmtP(x.payout)+'</span></button>';
}).join("");
};
hud.addEventListener("click",function(e){e.stopPropagation();panel.classList.toggle("on");render()});
if(closeBtn)closeBtn.addEventListener("click",function(){panel.classList.remove("on")});
document.addEventListener("click",function(e){if(panel.classList.contains("on")&&!e.target.closest("#pairPanel")&&!e.target.closest("#pairHud"))panel.classList.remove("on")});
list.addEventListener("click",function(e){
var b=e.target.closest("button.pit");if(!b)return;
var p=b.getAttribute("data-p");
if(e.target&&e.target.getAttribute&&e.target.getAttribute("data-s")){fav.has(p)?fav.delete(p):fav.add(p);render();return;}
panel.classList.remove("on");
var obj=pairs.find(function(x){return x.pair===p})||{pair:p,otc:1,flags:p.split("/")};setHud(obj);
try{if(window.chart&&typeof window.chart.switchPair==="function")window.chart.switchPair(p)}catch(_){}
});
setHud(pairs.find(function(x){return x.pair==="EUR/USD"})||pairs[0]);
render();
})();
</script>

<!-- ÿ≥ÿ¨ŸÑ ÿßŸÑÿµŸÅŸÇÿßÿ™ -->
<script>
(function(){
  var hb=document.getElementById("hb"),hs=document.getElementById("hs"),xBtn=document.getElementById("hX"),btn=document.getElementById("openHistory"),nav=document.getElementById("navHistory");
  var lst=document.getElementById("hList"),cnt=document.getElementById("hCnt"),hOpenCnt=document.getElementById("hOpenCnt"),tcOpen=document.getElementById("tcOpen"),tcClosed=document.getElementById("tcClosed");
  var tabOpen=document.getElementById("htabOpen"),tabClosed=document.getElementById("htabClosed");
  if(!hb||!hs||!lst) return;

  var state={openTrades:[],closedTrades:[],price:null,timer:null,activeTab:"open"};
  var F=function(cc){return "https://flagcdn.com/w40/"+cc+".png";};
  function z(n){return(n<10?"0":"")+n;}
  function fmtCountdown(sec){sec=Math.max(0,sec|0);var h=(sec/3600)|0,m=((sec%3600)/60)|0,s=sec%60;return z(h)+":"+z(m)+":"+z(s);}
  function fmtCloseTime(ts){if(!ts)return"--:--";var d=new Date(ts);return z(d.getDate())+"/"+z(d.getMonth()+1)+" "+z(d.getHours())+":"+z(d.getMinutes());}
  function num(x,d){x=+x;return isFinite(x)?x:d;}
  function fmt2(x){return(Math.round(num(x,0)*100)/100).toFixed(2);}

  function rowOpen(t){
    var p=state.price,entry=num(t.entry,null),pv={v:0,pos:false};
    if(p!=null&&entry!=null){var dir=(t.dir||"down")==="up"?"up":"down";var ok=(dir==="up")?(p>=entry):(p<=entry);pv=ok?{v:num(t.stake,10)*num(t.payout,0.85),pos:true}:{v:0,pos:false};}
    var dir=(t.dir||"down")==="up"?"up":"dn";
    return'<div class="hrw" data-id="'+(t.id||"")+'"><div class="lft"><span class="car">‚ñæ</span><div><div class="tm">'+fmtCountdown(num(t.remain,60))+'</div><div class="pf '+(pv.pos?'pos':'neg')+'">'+fmt2(pv.v)+' $</div></div></div><div class="rgt"><div class="pr"><span class="pair">'+(t.pair||"---")+'</span><span class="flg"><img src="'+F((t.flags&&t.flags[0])||"us")+'" alt=""><img src="'+F((t.flags&&t.flags[1])||"us")+'" alt=""></span></div><div class="amt"><span class="v '+(dir==="up"?'up':'dn')+'">$ '+(t.amountTxt||"--")+'</span><span class="d '+(dir==="up"?'up':'dn')+'"><span>'+(dir==="up"?"‚Üó":"‚Üò")+'</span></span></div></div></div>';
  }

  function rowClosed(t){
    var pl=num(t.profitLoss||t.profit,0),isWin=(t.result==="win")||pl>0,dir=(t.dir||"down")==="up"?"up":"dn";
    var timeStr=fmtCloseTime(t.closedAt||t.openTime),plTxt=isWin?"+"+fmt2(Math.abs(pl)):"-"+fmt2(Math.abs(pl));
    var carIco=isWin?'<span class="car" style="color:#22c55e;font-size:18px">‚úì</span>':'<span class="car" style="color:#e15353;font-size:18px">‚úó</span>';
    return'<div class="hrw closed" data-id="'+(t.id||"")+'"><div class="lft">'+carIco+'<div><div class="tm">'+timeStr+'</div><div class="pf '+(isWin?'pos':'neg')+'">'+plTxt+' $</div></div></div><div class="rgt"><div class="pr"><span class="pair">'+(t.pair||"---")+'</span><span class="flg"><img src="'+F((t.flags&&t.flags[0])||"us")+'" alt=""><img src="'+F((t.flags&&t.flags[1])||"us")+'" alt=""></span></div><div class="amt"><span class="v '+(dir==="up"?'up':'dn')+'">$ '+(t.amountTxt||"--")+'</span><span class="d '+(dir==="up"?'up':'dn')+'"><span>'+(dir==="up"?"‚Üó":"‚Üò")+'</span></span></div><div><span class="result-badge '+(isWin?'win':'loss')+'">'+(isWin?'WIN ‚úì':'LOSS ‚úó')+'</span></div></div></div>';
  }

  function render(){
    var nOpen=state.openTrades.length,nClosed=state.closedTrades.length,nTotal=nOpen+nClosed;
    if(cnt)cnt.textContent=String(nTotal);
    if(hOpenCnt)hOpenCnt.textContent=String(nOpen);
    if(tcOpen)tcOpen.textContent=String(nOpen);
    if(tcClosed)tcClosed.textContent=String(nClosed);

    var html="";
    if(state.activeTab==="open"){
      html=nOpen===0?'<div class="empty-msg"><span>üìÇ</span>ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿµŸÅŸÇÿßÿ™ ŸÖŸÅÿ™Ÿàÿ≠ÿ© ÿ≠ÿßŸÑŸäÿßŸã</div>':state.openTrades.map(rowOpen).join("");
    }else{
      html=nClosed===0?'<div class="empty-msg"><span>üìú</span>ŸÑÿß ŸäŸàÿ¨ÿØ ÿ≥ÿ¨ŸÑ ÿµŸÅŸÇÿßÿ™ ŸÖŸÜÿ™ŸáŸäÿ© ÿ®ÿπÿØ</div>':state.closedTrades.map(rowClosed).join("");
    }
    lst.innerHTML=html;
  }

  function tick(){state.openTrades.forEach(function(t){if(t.open===false)return;t.remain=Math.max(0,num(t.remain,0)-1);});if(state.activeTab==="open")render();}
  function ensureTimer(){if(state.timer)return;state.timer=setInterval(tick,1000);}

  function openPanel(){hb.classList.add("on");hs.classList.add("on");}
  function closePanel(){hb.classList.remove("on");hs.classList.remove("on");}
  function toggle(){hs.classList.contains("on")?closePanel():openPanel();}

  function setTrades(arr){state.openTrades=(Array.isArray(arr)?arr:[]).slice();render();ensureTimer();}
  function getTrades(){return state.openTrades.slice();}
  function updateTrade(id,patch){var t=state.openTrades.find(function(x){return String(x.id)===String(id);});if(!t)return;for(var k in patch)t[k]=patch[k];render();}
  function updatePrice(p){state.price=num(p,null);if(state.activeTab==="open")render();}

  function switchTab(tab){
    state.activeTab=tab;
    if(tabOpen)tabOpen.classList.toggle("active",tab==="open");
    if(tabClosed)tabClosed.classList.toggle("active",tab==="closed");
    render();
  }
  if(tabOpen)tabOpen.addEventListener("click",function(){switchTab("open");});
  if(tabClosed)tabClosed.addEventListener("click",function(){switchTab("closed");});

  function addClosedTrade(trade){
    if(!trade)return;
    state.openTrades=state.openTrades.filter(function(t){return String(t.id)!==String(trade.id);});
    var exists=state.closedTrades.find(function(t){return String(t.id)===String(trade.id);});
    if(!exists)state.closedTrades.unshift(trade);
    render();switchTab("closed");
  }
  function setHistory(arr){state.closedTrades=(Array.isArray(arr)?arr:[]).slice();render();}
  function loadHistory(arr){setHistory(arr);}
  function addHistory(trade){addClosedTrade(trade);}

  if(btn)btn.addEventListener("click",function(e){e.stopPropagation();toggle();});
  if(nav)nav.addEventListener("click",function(e){e.stopPropagation();toggle();});
  hb.addEventListener("click",closePanel);
  if(xBtn)xBtn.addEventListener("click",closePanel);
  document.addEventListener("keydown",function(e){if(e.key==="Escape")closePanel();});

  setInterval(function(){if(typeof window.__qt_price==="number")updatePrice(window.__qt_price);},250);

  window.addEventListener("qt_trade_closed",function(e){if(e&&e.detail&&e.detail.trade)addClosedTrade(e.detail.trade);});
  window.addEventListener("qt_history_loaded",function(e){
    if(e&&e.detail&&Array.isArray(e.detail)){
      setHistory(e.detail);
      if(e.detail.length>0)switchTab("closed");
    }
  });

  window.tradeHistory={open:openPanel,close:closePanel,toggle:toggle,setTrades:setTrades,getTrades:getTrades,updateTrade:updateTrade,updatePrice:updatePrice,addHistory:addHistory,addClosedTrade:addClosedTrade,setHistory:setHistory,loadHistory:loadHistory,setPriceFromChartVar:function(varName){setInterval(function(){var v=window[varName];if(typeof v==="number")updatePrice(v);},250);}};
  render();ensureTimer();
})();
</script>

<!-- chart.js -->
<script type="module" src="chart.js"></script>
</body></html>
